<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper				
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"			
	"https://mybatis.org/dtd/mybatis-3-mapper.dtd">			
<mapper namespace="sai.pork.board.mapper.BoardMapper">	

	<select id="getAllBoards" resultType="sai.pork.board.model.BoardDTO">
		SELECT * FROM boards ORDER BY board_seq DESC
	</select>
	
	<!-- parameterType이 String이면 #{id}는 잘 안받아와짐. #{value}로 하는것이 좋음 -->
	<!-- 그래서 String 말고 Map을 사용함 -->
	<select id="getSpecificBoards" parameterType="Map" resultType="sai.pork.board.model.BoardDTO">
		SELECT * FROM boards
		WHERE board_category = #{category}
		ORDER BY ${orderBy} DESC
	</select>
	
	<!-- 카테고리가 전체 일때 -->
	<select id="getTotalSpecificBoards" parameterType="Map" resultType="sai.pork.board.model.BoardDTO">
		SELECT * FROM boards
		ORDER BY ${orderBy} DESC
	</select>	
	
	<select id="getSearchedBoards" parameterType="Map" resultType="sai.pork.board.model.BoardDTO">
		SELECT * FROM boards
		WHERE board_category = #{category} AND ${searchCategory} LIKE '%'||#{searchKeyword}||'%'
		ORDER BY ${orderBy} DESC
	</select>
	
	<!-- 카테고리가 전체 일때 -->
	<select id="getTotalSearchedBoards" parameterType="Map" resultType="sai.pork.board.model.BoardDTO">
		SELECT * FROM boards
		WHERE ${searchCategory} LIKE '%'||#{searchKeyword}||'%'
		ORDER BY ${orderBy} DESC
	</select>
	
	<select id="getBoard" parameterType="Integer" resultType="sai.pork.board.model.BoardDTO">
		SELECT * FROM boards
		WHERE board_seq = #{board_seq}
	</select>

	<insert id="writeComment" parameterType="Map">
		INSERT INTO comments VALUES(comment_seq.nextval, #{board_seq}, #{comment_id}, #{comment_pw}, #{comment_content}, sysdate));
	</insert>
	
	<select id="getComments" parameterType="Integer" resultType="sai.pork.board.model.CommentDTO">
		SELECT * FROM comments WHERE board_seq=#{board_seq} ORDER BY comment_seq DESC
	</select>
	
	<select id="updateView" parameterType="Integer">
		UPDATE boards SET board_view = board_view + 1 WHERE board_seq = #{board_seq}
	</select>
	
	<select id="passwordCheck" parameterType="Integer">
		SELECT board_pw FROM boards WHERE board_seq = #{board_seq}
	</select>
	
	<delete id="deleteBoard" parameterType="Integer">
		DELETE FROM boards WHERE board_seq = #{board_seq}
	</delete>
	
	<!-- <update id="updateBoard" parameterType="sai.pork.board.model.BoardDTO">
		UPDATE boards SET board_
	</update> -->

</mapper>